{"ast":null,"code":"import _defineProperty from\"D:/I2T/Smarttech/tourbookingwebgit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/I2T/Smarttech/tourbookingwebgit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/I2T/Smarttech/tourbookingwebgit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory,useLocation}from'react-router-dom';import{CCard,CCardBody,CCardHeader,CCol,CRow,CButton,CModal,CModalTitle,CModalHeader,CModalBody,CForm,CInputGroupPrepend,CInputGroupText,CInputGroup,CInput,CFormGroup,CInputCheckbox,CLabel,CModalFooter,CBadge,CImg}from'@coreui/react';import DataTable from\"react-data-table-component\";import DataTableExtensions from\"react-data-table-component-extensions\";import Select from'react-select';import CIcon from'@coreui/icons-react';import dataservice from'../../service/dataservice';import{toast}from'react-toastify';import{CSVLink}from\"react-csv\";import DatePicker from\"react-date-picker\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var notify=function notify(type,message,systemerror){switch(type){case 1:toast.success(message,{position:toast.POSITION.TOP_CENTER});break;case 2:var dtlmsg;if(systemerror!==undefined){dtlmsg=/*#__PURE__*/_jsxs(\"div\",{children:[\"Please contact to administrator!\",/*#__PURE__*/_jsx(\"br\",{}),message]});}else{dtlmsg=/*#__PURE__*/_jsx(\"div\",{children:message});}toast.error(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CIcon,{name:\"cil-warning\"}),\" Error\",dtlmsg]}),{position:toast.POSITION.TOP_CENTER});break;default:break;}};var headerss=[{label:\"Transaction id\",key:\"paymentreferencenumber\"},{label:\"Primary Contact Name\",key:\"primaryguest\"},{label:\"Primary Contact Email\",key:\"email\"},{label:\"Mobile Number\",key:\"mobilenumber\"},{label:\"Guest List\",key:\"other\"},{label:\"Hotel\",key:\"hotel\"},{label:\"From Date\",key:\"fromdate\"},{label:\"TO Date\",key:\"todate\"},{label:\"Number Of Tourist\",key:\"pax\"},{label:\"Bracelet Buy\",key:\"buybracelet\"},{label:\"Bracelet Rented\",key:\"rentbracelet\"},{label:\"Time\",key:\"slotid\"},{label:\"Vehicle Parking\",key:\"vehicle\"}];var TransactionLog=function TransactionLog(){var processing=process.env.PUBLIC_URL+\"/processing.gif\";var _useState=useState([]),_useState2=_slicedToArray(_useState,2),csvdata=_useState2[0],setCSVData=_useState2[1];var _useState3=useState([new Date()]),_useState4=_slicedToArray(_useState3,2),selectedfromdate=_useState4[0],setFromdate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isprocessing=_useState6[0],setIsProcessing=_useState6[1];var setselectedfromdate=function setselectedfromdate(e){setFromdate(e);//setTodate(e);\n};var _useState7=useState([new Date()]),_useState8=_slicedToArray(_useState7,2),selectedtodate=_useState8[0],setTodate=_useState8[1];var setselectedtodate=function setselectedtodate(e){setTodate(e);var todata=e;var fromdata=selectedfromdate[0]==undefined?selectedfromdate:selectedfromdate[0];};var url=\"https://maubantourism.smartpay.ph/tourbookingphp/tempdata/\";//var url=\"https://tourism-test.smartpay.ph/tourbookingphp/tempdata/\";\nvar gettransactiondata=function gettransactiondata(){setIsProcessing(true);var fromdata=selectedfromdate[0]==undefined?selectedfromdate:selectedfromdate[0];var todate=selectedtodate[0]==undefined?selectedtodate:selectedtodate[0];dataservice(\"report\",{requestfor:'transactionlog_new',data:{flag:'a',fromdate:moment(fromdata).format(\"YYYY-MM-DD\"),todate:moment(todate).format(\"YYYY-MM-DD\")}}).then(function(data){setIsProcessing(false);if(data.resultkey==1){var result=data.resultvalue;setTransactionLog(_objectSpread(_objectSpread({},TransactionLogdata),{},_defineProperty({},\"data\",result)));if(result.length>0){var datasd=[];for(var index=0;index<result.length;index++){var element=result[index];datasd.push({paymentreferencenumber:element.paymentreferencenumber,primaryguest:element.primaryguest,email:element.email,mobilenumber:element.mobilenumber,other:element.other,hotel:element.hotel,fromdate:element.fromdate,todate:element.todate,pax:element.pax,buybracelet:element.buybracelet,rentbracelet:element.rentbracelet,slotid:element.slotid,vehicle:element.vehicle});}setCSVData(datasd);}}else{//  notify(2,\"No data found\");\n}}).catch(function(edata){setIsProcessing(false);notify(2,edata.toString(),1);});};useEffect(function(){gettransactiondata();},[]);var search=function search(){gettransactiondata();};var columns=[{name:'Transaction id',selector:'paymentreferencenumber',sortable:true},{name:'Primary Contact Name',selector:'primaryguest',sortable:true},{name:'Primary Contact Email',selector:'email',sortable:true},{name:'Mobile Number',selector:'mobilenumber',sortable:true},{name:'Guest List',selector:'other',sortable:true},{name:'Hotel',selector:'hotel',sortable:true},{name:'From Date',selector:'fromdate',sortable:true},{name:'TO Date',selector:'todate',sortable:true},{name:'Number Of Tourist',selector:'pax',sortable:true},{name:'Bracelet Buy',selector:'buybracelet',sortable:true},{name:'Bracelet Rent',selector:'rentbracelet',sortable:true},{name:'Time ',selector:'slotid',sortable:true},{name:'vehicle',selector:'vehicle',sortable:true},{name:'qrcode',selector:'qrcode',sortable:true,cell:function cell(d){return/*#__PURE__*/_jsx(\"img\",{width:\"50\",height:\"50\",src:url+d.qrcode,alt:\"slide 1\"});}}//,\n// {\n//   name: 'Status',\n//   selector: 'isactive',\n//   sortable: true,\n//   cell: d => <CBadge color={d.isactive==\"1\"?\"success\":\"danger\"}>\n//                       {d.isactive==\"1\"?\"Active\":\"In Active\"}\n//                      </CBadge>,\n// }\n];var data=[];var _useState9=useState({columns:columns,data:data}),_useState10=_slicedToArray(_useState9,2),TransactionLogdata=_useState10[0],setTransactionLog=_useState10[1];return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(CRow,{children:/*#__PURE__*/_jsx(CCol,{xl:12,children:/*#__PURE__*/_jsxs(CCard,{children:[/*#__PURE__*/_jsx(CCardHeader,{children:/*#__PURE__*/_jsx(CRow,{children:/*#__PURE__*/_jsxs(CCol,{xl:6,children:[/*#__PURE__*/_jsx(CImg,{src:processing,height:\"50\",width:\"50\",style:{display:isprocessing==true?\"\":\"none\"},alt:\"qrcode\"}),\"  Transaction Log\",/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\" Report\"})]})})}),/*#__PURE__*/_jsxs(CCardBody,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4 col-md-12 mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"country\",children:\"From Date\"}),/*#__PURE__*/_jsx(DatePicker,{className:\"form-control\",value:selectedfromdate,onChange:setselectedfromdate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4 col-md-12 mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"country\",children:\"To Date\"}),/*#__PURE__*/_jsx(DatePicker,{className:\"form-control\",value:selectedtodate,onChange:setselectedtodate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4 col-md-12 mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"country\",children:\"Search\"}),/*#__PURE__*/_jsx(CButton,{block:true,onClick:function onClick(){return search();},color:\"primary\",children:\"Search\"})]})]}),/*#__PURE__*/_jsx(CSVLink,{className:\"mr-1 btn btn-primary\",style:{float:\"right\"},data:csvdata,headers:headerss,filename:\"Transactionlog.csv\",children:\"Download csv\"}),/*#__PURE__*/_jsx(DataTableExtensions,_objectSpread(_objectSpread({},TransactionLogdata),{},{children:/*#__PURE__*/_jsx(DataTable,{defaultSortField:\"id\",defaultSortAsc:false,pagination:true,highlightOnHover:true})}))]})]})})})});};export default TransactionLog;","map":{"version":3,"sources":["D:/I2T/Smarttech/tourbookingwebgit/src/views/Reports/TransactionLog/TransactionLog.js"],"names":["React","useState","useEffect","useHistory","useLocation","CCard","CCardBody","CCardHeader","CCol","CRow","CButton","CModal","CModalTitle","CModalHeader","CModalBody","CForm","CInputGroupPrepend","CInputGroupText","CInputGroup","CInput","CFormGroup","CInputCheckbox","CLabel","CModalFooter","CBadge","CImg","DataTable","DataTableExtensions","Select","CIcon","dataservice","toast","CSVLink","DatePicker","moment","notify","type","message","systemerror","success","position","POSITION","TOP_CENTER","dtlmsg","undefined","error","headerss","label","key","TransactionLog","processing","process","env","PUBLIC_URL","csvdata","setCSVData","Date","selectedfromdate","setFromdate","isprocessing","setIsProcessing","setselectedfromdate","e","selectedtodate","setTodate","setselectedtodate","todata","fromdata","url","gettransactiondata","todate","requestfor","data","flag","fromdate","format","then","resultkey","result","resultvalue","setTransactionLog","TransactionLogdata","length","datasd","index","element","push","paymentreferencenumber","primaryguest","email","mobilenumber","other","hotel","pax","buybracelet","rentbracelet","slotid","vehicle","catch","edata","toString","search","columns","name","selector","sortable","cell","d","qrcode","display","float"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\nimport {\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCol,\r\n  CRow,\r\n  CButton,\r\n  CModal,\r\n  CModalTitle,\r\n  CModalHeader,\r\n  CModalBody,\r\n  CForm,\r\n  CInputGroupPrepend,\r\n  CInputGroupText,\r\n  CInputGroup,\r\n  CInput,\r\n  CFormGroup,\r\n  CInputCheckbox,\r\n  CLabel,\r\n  CModalFooter,\r\n  CBadge, CImg\r\n} from '@coreui/react'\r\n\r\nimport DataTable from \"react-data-table-component\";\r\nimport DataTableExtensions from \"react-data-table-component-extensions\";\r\nimport Select from 'react-select';\r\nimport CIcon from '@coreui/icons-react';\r\nimport dataservice from '../../service/dataservice';\r\nimport { toast } from 'react-toastify';\r\nimport { CSVLink } from \"react-csv\";\r\nimport DatePicker from \"react-date-picker\";\r\nimport moment from \"moment\";\r\n\r\n\r\n\r\nconst notify = (type, message, systemerror) => {\r\n  switch (type) {\r\n    case 1:\r\n      toast.success(message, {\r\n        position: toast.POSITION.TOP_CENTER\r\n      });\r\n      break;\r\n    case 2:\r\n      var dtlmsg;\r\n      if (systemerror !== undefined) {\r\n        dtlmsg = <div>Please contact to administrator!<br></br>{message}</div>;\r\n      } else {\r\n        dtlmsg = <div>{message}</div>;\r\n      }\r\n\r\n      toast.error(<div>\r\n        <CIcon name=\"cil-warning\" /> Error\r\n\r\n        {dtlmsg}\r\n\r\n      </div>, {\r\n        position: toast.POSITION.TOP_CENTER\r\n      });\r\n      break;\r\n\r\n    default:\r\n      break;\r\n  }\r\n}\r\nconst headerss = [\r\n  { label: \"Transaction id\", key: \"paymentreferencenumber\" },\r\n  { label: \"Primary Contact Name\", key: \"primaryguest\" },\r\n  { label: \"Primary Contact Email\", key: \"email\" },\r\n  { label: \"Mobile Number\", key: \"mobilenumber\" },\r\n  { label: \"Guest List\", key: \"other\" },\r\n  { label: \"Hotel\", key: \"hotel\" },\r\n  { label: \"From Date\", key: \"fromdate\" },\r\n  { label: \"TO Date\", key: \"todate\" },\r\n  { label: \"Number Of Tourist\", key: \"pax\" },\r\n  { label: \"Bracelet Buy\", key: \"buybracelet\" },\r\n  { label: \"Bracelet Rented\", key: \"rentbracelet\" },\r\n  { label: \"Time\", key: \"slotid\" },\r\n  { label: \"Vehicle Parking\", key: \"vehicle\" }\r\n\r\n];\r\n\r\nconst TransactionLog = () => {\r\n  var processing = process.env.PUBLIC_URL + \"/processing.gif\";\r\n  const [csvdata, setCSVData] = useState([]);\r\n  const [selectedfromdate, setFromdate] = useState([new Date()]);\r\n  const [isprocessing, setIsProcessing] = useState(false);\r\n\r\n  const setselectedfromdate = (e) => {\r\n    setFromdate(e);\r\n    //setTodate(e);\r\n\r\n  };\r\n\r\n  const [selectedtodate, setTodate] = useState([new Date()]);\r\n  const setselectedtodate = (e) => {\r\n    setTodate(e);\r\n    var todata = e;\r\n    var fromdata =\r\n      selectedfromdate[0] == undefined ? selectedfromdate : selectedfromdate[0];\r\n\r\n  };\r\n\r\n\r\n  var url = \"https://maubantourism.smartpay.ph/tourbookingphp/tempdata/\";\r\n  //var url=\"https://tourism-test.smartpay.ph/tourbookingphp/tempdata/\";\r\n  const gettransactiondata = () => {\r\n    setIsProcessing(true);\r\n    var fromdata =\r\n      selectedfromdate[0] == undefined ? selectedfromdate : selectedfromdate[0];\r\n    var todate =\r\n      selectedtodate[0] == undefined ? selectedtodate : selectedtodate[0];\r\n    dataservice(\"report\", {\r\n      requestfor: 'transactionlog_new', data: {\r\n        flag: 'a',\r\n        fromdate: moment(fromdata).format(\"YYYY-MM-DD\"), todate: moment(todate).format(\"YYYY-MM-DD\")\r\n      }\r\n    })\r\n      .then(function (data) {\r\n        setIsProcessing(false);\r\n        if (data.resultkey == 1) {\r\n          var result = data.resultvalue;\r\n\r\n          setTransactionLog({ ...TransactionLogdata, [\"data\"]: result });\r\n          if (result.length > 0) {\r\n            let datasd = [];\r\n            for (let index = 0; index < result.length; index++) {\r\n              const element = result[index];\r\n              datasd.push(\r\n                {\r\n                  paymentreferencenumber: element.paymentreferencenumber,\r\n                  primaryguest: element.primaryguest,\r\n                  email: element.email,\r\n                  mobilenumber: element.mobilenumber,\r\n                  other: element.other,\r\n                  hotel: element.hotel,\r\n                  fromdate: element.fromdate,\r\n                  todate: element.todate,\r\n                  pax: element.pax,\r\n                  buybracelet: element.buybracelet,\r\n                  rentbracelet: element.rentbracelet,\r\n                  slotid: element.slotid,\r\n                  vehicle: element.vehicle\r\n                }\r\n              );\r\n\r\n            }\r\n            setCSVData(datasd);\r\n          }\r\n\r\n        } else {\r\n          //  notify(2,\"No data found\");\r\n        }\r\n\r\n      })\r\n      .catch(function (edata) {\r\n        setIsProcessing(false);\r\n        notify(2, edata.toString(), 1);\r\n      });\r\n\r\n\r\n\r\n  }\r\n  useEffect(() => {\r\n\r\n    gettransactiondata();\r\n\r\n\r\n  }, [])\r\n\r\n  const search = () => {\r\n    gettransactiondata();\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  const columns = [\r\n    {\r\n      name: 'Transaction id',\r\n      selector: 'paymentreferencenumber',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Primary Contact Name',\r\n      selector: 'primaryguest',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Primary Contact Email',\r\n      selector: 'email',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Mobile Number',\r\n      selector: 'mobilenumber',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Guest List',\r\n      selector: 'other',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Hotel',\r\n      selector: 'hotel',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'From Date',\r\n      selector: 'fromdate',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'TO Date',\r\n      selector: 'todate',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Number Of Tourist',\r\n      selector: 'pax',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Bracelet Buy',\r\n      selector: 'buybracelet',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Bracelet Rent',\r\n      selector: 'rentbracelet',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'Time ',\r\n      selector: 'slotid',\r\n      sortable: true,\r\n    },\r\n    {\r\n      name: 'vehicle',\r\n      selector: 'vehicle',\r\n      sortable: true,\r\n    },\r\n\r\n    {\r\n      name: 'qrcode',\r\n      selector: 'qrcode',\r\n      sortable: true,\r\n      cell: d => <img width='50' height='50' src={url + d.qrcode} alt=\"slide 1\" />,\r\n\r\n\r\n    }\r\n    //,\r\n    // {\r\n    //   name: 'Status',\r\n    //   selector: 'isactive',\r\n    //   sortable: true,\r\n    //   cell: d => <CBadge color={d.isactive==\"1\"?\"success\":\"danger\"}>\r\n    //                       {d.isactive==\"1\"?\"Active\":\"In Active\"}\r\n    //                      </CBadge>,\r\n    // }\r\n\r\n  ];\r\n  const data = [];\r\n  const [TransactionLogdata, setTransactionLog] = useState({\r\n    columns,\r\n    data\r\n  });\r\n  return (\r\n    <>\r\n      <CRow>\r\n        <CCol xl={12}>\r\n          <CCard>\r\n            <CCardHeader>\r\n              <CRow>\r\n                <CCol xl={6}>\r\n                  <CImg\r\n                    src={processing}\r\n                    height=\"50\"\r\n                    width=\"50\"\r\n                    style={{ display: isprocessing == true ? \"\" : \"none\" }}\r\n                    alt=\"qrcode\"\r\n                  />  Transaction Log\r\n                  <small className=\"text-muted\"> Report</small>\r\n                </CCol>\r\n\r\n              </CRow>\r\n\r\n\r\n\r\n            </CCardHeader>\r\n            <CCardBody>\r\n              <div className='row'>\r\n                <div className=\"col-lg-4 col-md-12 mb-4\">\r\n                  <label for=\"country\">\r\n                    From Date\r\n                  </label>\r\n                  <DatePicker\r\n                    className=\"form-control\"\r\n                    value={selectedfromdate}\r\n                    onChange={setselectedfromdate}\r\n                  />\r\n                </div>\r\n                <div className=\"col-lg-4 col-md-12 mb-4\">\r\n                  <label for=\"country\">\r\n                    To Date\r\n                  </label>\r\n                  <DatePicker\r\n                    className=\"form-control\"\r\n                    value={selectedtodate}\r\n                    onChange={setselectedtodate}\r\n                  />\r\n                </div>\r\n                <div className=\"col-lg-4 col-md-12 mb-4\">\r\n                  <label for=\"country\">\r\n                    Search\r\n                  </label>\r\n                  <CButton block onClick={() => search()} color=\"primary\">\r\n                    Search\r\n                  </CButton>\r\n                </div>\r\n              </div>\r\n              <CSVLink className=\"mr-1 btn btn-primary\" style={{ float: \"right\" }} data={csvdata} headers={headerss} filename={\"Transactionlog.csv\"}>\r\n                Download csv\r\n              </CSVLink>\r\n\r\n              <DataTableExtensions\r\n                {...TransactionLogdata}\r\n\r\n              >\r\n\r\n\r\n                <DataTable\r\n                  defaultSortField=\"id\"\r\n                  defaultSortAsc={false}\r\n                  pagination\r\n                  highlightOnHover\r\n\r\n                />\r\n              </DataTableExtensions>\r\n\r\n            </CCardBody>\r\n          </CCard>\r\n        </CCol>\r\n      </CRow>\r\n    </>\r\n\r\n  )\r\n}\r\nexport default TransactionLog"]},"metadata":{},"sourceType":"module"}